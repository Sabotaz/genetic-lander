<html>
    <header>
        <title>Test</title>
        <script type="text/javascript" src="d3.min.js"></script>
        <script type="text/javascript" src="script.js"></script>
    </header>
    <body>
        <script type="text/javascript">
            function rainbow(numOfSteps, step) {
                // This function generates vibrant, "evenly spaced" colours (i.e. no clustering). This is ideal for creating easily distinguishable vibrant markers in Google Maps and other apps.
                // Adam Cole, 2011-Sept-14
                // HSV to RBG adapted from: http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript
                var r, g, b;
                var h = step / numOfSteps;
                var i = ~~(h * 6);
                var f = h * 6 - i;
                var q = 1 - f;
                switch (i % 6) {
                    case 0: r = 1; g = f; b = 0; break;
                    case 1: r = q; g = 1; b = 0; break;
                    case 2: r = 0; g = 1; b = f; break;
                    case 3: r = 0; g = q; b = 1; break;
                    case 4: r = f; g = 0; b = 1; break;
                    case 5: r = 1; g = 0; b = q; break;
                }
                var c = "#" +
                    ("00" + (~ ~(r * 255)).toString(16)).slice(-2) +
                    ("00" + (~ ~(g * 255)).toString(16)).slice(-2) +
                    ("00" + (~ ~(b * 255)).toString(16)).slice(-2);
                return c;
            }

            // Load level
            var level = Object.create(Level).init(level1data);
            
            // Create landers
            var NUMBER_OF_LANDERS = 100;
            for (var i = 0; i < NUMBER_OF_LANDERS; i++) {
                level.landers.push(
                    Object.create(Lander)
                        .init(level.defaultLanderFields)
                        .setColor(rainbow(NUMBER_OF_LANDERS * 5, i))
                        .createRandomCommands(100)
                )
            }

            // Fly you fools
            for (var t = 0; t < 100; t++) {
                for (var i = 0; i < NUMBER_OF_LANDERS; i++) {
                    var lander = level.landers[i]

                    // Set next command
                    lander.angle = lander.commands[t][0];
                    lander.power = lander.commands[t][1];

                    // Check if we crashed
                    // TODO
                }
                level.tick();
            }
            level.draw();
        </script>
    </body>
</html>